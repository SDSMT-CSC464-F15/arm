% New Templete!!
% !TEX root = DesignDocument.tex


\chapter{Experimental Log}

For research projects one needs to keep a log of all research/lab activities.

%% If you have multiple labs, you may want to break the labs into sections, check 
%% with the profession on format.
%% \section{Lab 1}

%%\begin{description}
%%\item [10/15/15]  Ran modified filter on data sets 1 - 6.  Results were ...
%%\item [10/17/15]  Changed tolerance on sensor and collected data.  These ...
%%\end{description}

% Sprint 1
\section{Benchmarking the Individual Computers}

\begin{description}
\item [9/17/15]  PcDuino isn't working according to Dr. Karlsson. The PcDuinos are about \$160 each, so chances were that the PcDuino wasn't going to be selected for the cluster. We will not put the PcDuino in consideration with our benchmarking. \\

\item [9/17/15]  PcDuino isn't working according to Dr. Karlsson. The PcDuinos are about \$160 each, so chances were that the PcDuino wasn't going to be selected for the cluster. We will not put the PcDuino in consideration with our benchmarking. \\

\item [9/22/15] We begin work on benchmarking the remaining candidates. The code we will be using to benchmark the two devices will test the addition, multiplication, division, trigonmetric function in single and double point precision of two massively large arrays filled with random numbers. \\

\item [9/29/15] OpenMP is added to the benchmark code so the program runs on all cores. Results are as follows: \\

\begin{center}
\begin{tabular}{ | l || l | l | l | l | }
\hline
\multicolumn{5}
{ |c| }{ Length of Time (seconds) } \\
\hline
Device & Addition & Multiplication & Division & Sine \\
\hline
ODroid 4xU & 29.925 & 31.341 & 37.032 & 227.40 \\
\hline
Raspberry Pi 2B & 221.645 & 221.034 & 297.204 & 1468.63 \\
\hline
\end{tabular}
\end{center}

\item [9/30/15] The gigaflops are calculated. \\
\begin{center}
\begin{tabular}{ | l || l | l | l | l | }
\hline
\multicolumn{5}
{ |c| }{ Gigaflops } \\
\hline
Device & Addition & Multiplication & Division & Sine \\
\hline
ODroid 4xU & 0.311 & 0.297 & 0.251 & 0.0410 \\
\hline
Raspberry Pi 2B & 0.0420 & 0.0421 & 0.0313 & 0.00634 \\
\hline
\end{tabular}
\end{center}

\item [10/1/15] The wattage is measured when the devices are running these operations. Using the wattage, the metric of GFlops/Dollar/Watt is calculated. \\

\begin{center}
\begin{tabular}{ | l || l | l | l | l | }
\hline
\multicolumn{5}
{ |c| }{ Gigaflops per Dollar per Watts } \\
\hline
Device & Addition & Multiplication & Division & Sine \\
\hline
ODroid 4xU & 0.00028 & 0.000268 & 0.000226 & 0.0000369 \\
\hline
Raspberry Pi 2B & 0.0003 & 0.0003 & 0.000224 & 0.0000453 \\
\hline
\end{tabular}
\end{center}

\item [10/1/15] The results show that the Raspberry Pi and the ODroid perform nearly the same. The Raspberry Pi in our benchmarking proved the best. However, it is inconclusive as to which computer will be used. \\

\item [10/24/15] Decided to go with the ODroid. Performance and the number of ports outweighted the cost of the Raspberry Pi. \\

\end{description}

% Sprint 2
\section{Ethernet Benchmark}
\begin{description}
\item [10/25/15] Created network between a machine with gigabit Ethernet port and ODROID. Installed iperf, a tool in the standard Debian repositories to text the network speed, on both the server machine and ODROID. \\

This text can be run over the existing network by the following steps: \\ \\
> ssh andrewdesktop@108.107.223.45 \\
Password: design \\
>iperf -s \& \\ \\
Leave that running in the background. \\ \\
>ssh odroid@10.42.0.2 \\
Password: odroid \\
>iperf -c 10.42.0.1 \\ \\
This will take a few seconds to run then give the network speed. The network 10.42.0.1 is over a 1000 Mbps wired connection between the ODROID and andrewdesktop. \\

\begin{center}
\begin{tabular}{ | l || l | }
\hline
\multicolumn{2}
{ |c| }{ Ethernet Speed } \\
\hline
Device & Speed (Mbps) \\
\hline
ODroid XU4 & 615 - 625 \\
\hline
\end{tabular}
\end{center}

\end{description}

\section{Hardware Test}
\begin{description}
\item [11/03/15] All eight ODroids are functional. To test them, each device was connected to a router with internet access via Ethernet. A monitor was connected through HDMI, and the mouse and keyboard were connected to both USB 3.0 ports to ensure they worked. The packages mpi-default-dev and openmpi-bin were installed. The test MPI code found this directory and successfully compiled and executed. No issues found on any device. \\
\end{description}

\section{Switch Benchmark}
\begin{description}
\item [11/03/15] With two ODROID devices attached to the switch via direct ethernet (no USB 3.0 to ethernet adapter), the connection speed was tested. This was accomplished by one device running: \\ \\
> iperf -s \\ \\
and the other running: \\ \\
> iperf -c [IP of the first device]

\begin{center}
\begin{tabular}{ | l || l | }
\hline
\multicolumn{2}
{ |c| }{ Switch Speed } \\
\hline
Device & Speed (Mbps) \\
\hline
ODroid XU4 & 775 - 800 \\
\hline
\end{tabular}
\end{center}

This is notably faster than the previous benchmark between one ODROID and a non-ODROID machine not using a switch.
\end{description}

\section{USB to Ethernet Benchmark}
\begin{description}
\item [11/03/15] Tested speed of USB 3.0 to ethernet adapter using iperf. Found slower than direct ethernet conection. Test speeds varied greatly, between 300 Mbps and 700 Mbps. The USB ethernet adapted was faster acting as a server than a client with the highest value as a client being only about 475 Mbps. In contrast, the ethernet connections were consistent reguarless of which device was the client or server, and stayed between 775 and 800 Mbps. 

\begin{center}
\begin{tabular}{ | l || l | }
\hline
\multicolumn{2}
{ |c| }{ USB 3.0 to Ethernet Adapter Speed } \\
\hline
Device & Speed (Mbps) \\
\hline
ODroid XU4 & 300 - 700 \\
\hline
\end{tabular}
\end{center}

Additionally, there hasn't been a found way to connect two devices over USB-ethernet to ethernet directly. When attached to the switch, the devices can communicate; however, if we were using the USB to ethernet adapters, they would be directly connected, without the switch. Therefore, being unable to direct connect devices defeats the purpose of the adapters. In conclusion, the drastically lower speed of the USB to Ethernet adapters and the inability to directly connect devices means that the devices are very unlikely to useful for our purposes. \\

\item [11/05/15] There isn't a found way to connect two devices over USB-ethernet to ethernet directly. When attached to the switch, the devices can communicate. If using the USB to ethernet adapter, they would be directly connected without the switch. Therefore, it was unable to directly connect devices. \\ \\
The drastically lower speed of the USB to ethernet adapters and the inability to directly connect the devices means that the devices are very unlikely to be useful for this project.
\end{description}

%Sprint 3
\section{Auto-Mounting Snow White's Home Directory}
\begin{description}
\item [11/10/15] Attempting to auto-mount Snow White's homedirectory onto the dwarfs. Changed Sleepy's fstab file with this line: \\ \\
> 192.168.1.11:/home /home nfs auto 0 0 \\ \\
We can now mount Snow White's home directory automatically onto Sleepy. Adding this to other dwarfs' fstab file.
\end{description}

%%%% THIS NEEDS TO BE FINISHED
\section{Assigning IP Addresses}
\begin{description}
\item [11/5/15] Setting up the IP addresses for the ODROIDs. \\ \\
> sudo vim /etc/network/interfaces \\ \\
These lines should be in there: \\ \\
\# interfaces(5) file used by ifup(8) and ifdown(8) \\
\# Include files from /etc/network/interfaces.d \\
source-directory /etc/network/interfaces.d \\
auto eth0 \\
iface eth0 inet static \\
address 192.168.1.11 \\
gateway 192.168.1.1 \\ \\
Under address, edit what address you want.\\
Confirm the ip address was changed: \\ \\
> ifconfig \\ \\
Switch control to another ODROID connected on the switch. \\
Attempt to ping to the ODROID who's IP address you changed. \\ \\
> ping 192.168.1.11 \\ \\
It should be successful. Attempt to ssh into it. \\ \\
> ssh 192.168.1.11 \\ \\
Use iperf to time and ping the network. Set up the server and set the client \\ \\
> iperf -s \\
> iperf -c 192.168.1.11 \\
%% I NEED HELP WITH THIS ONE
\end{description}

\section{Naming the Dwarfs}
\begin{description}
\item[11/10/15] Changing the hostnames of the ODROIDs. Working on ODROID 2, it's being difficult so I will name it Dopey. To change the hostname: \\ \\
> sudo vim /etc/hostname \\ \\
Overwrite ``odroid'' with ``Dopey'' \\ \\
> sudo vim /etc/hosts \\ \\
Replace ``127.0.0.1 odroid'' to ``127.0.0.1 dopey''. \\ \\
In /etc/nsswitch.conf, change ``hosts: files mdns4\textunderscore minimal [NOTFOUND=return] dns'' to ``hosts: files dns''
\end{description}

\section{Getting Internet on the ODROIDs}
\begin{description}
\item [11/13/15] We need internet access on the ODROIDs to install applications, such as vim. To get the internet, we had to plug in Ethernet to internet and then edit /etc/network/interfaces. Then needed to reset eth0: \\ \\
> sudo ifdown eth0 \\
> sudo ifup eth0 \\ \\
That didn't always work. Rebooting is another option.
\end{description}

\section{SSH-ing Via Hostame}
\begin{description}
\item [11/17/15] For ease of use, we need to be able to ssh into each of the dwarfs by their given name. In order to do that, we need to add a list of every ODROID and their corresponding IP address to each ODROID. \\
>sudo vim /etc/hosts \\ \\
In there, add the others' IP Addresses and hostnames in this format: \\
<ipaddress> <hostname> \\
Example: 192.188.1.11 snowwhite \\ \\
In order to perform MPI, we need to take down the passwords from each of the ODROIDs so you don't need them when you ssh: \\
>ssh-keygen \\ \\
Press enter through all of the promts, then: \\
> ssh-copy-id <ipaddress>
\end{description}

\section{Starting up the Cluster}
\begin{description}
\item [12/1/15] We developed a procedure to safely start of the cluser:
\begin{enumerate}
	\item Plug the cluster into power. This will start up Snow White, the power box, and the switch.
	\item Flip the two switches at the top of the cluster. Those will start the remaining dwarfs in their corresponding columns.
\end{enumerate}
It is important to run the procedure in this order so Snow White's home directory will successfully mount in the other dwarfs.
\end{description}

\section{IP Addresses}
\begin{description}
\item [12/1/15] We assigned IP addresses to the ODROIDs:
\begin{itemize}
	\item IP ADDRESS - hostname
	\item 192.168.1.11 - snow\textunderscore white
	\item 192.168.1.12 - dopey
	\item 192.168.1.13 - sleepy
	\item 192.168.1.14 - grumpy
	\item 192.168.1.15 - doc
	\item 192.168.1.16 - happy
	\item 192.168.1.17 - bashful
	\item 192.168.1.18 - sneezy
\end{itemize}
\end{description}

\section{Formatting Executable Commands}
\begin{description}
\item [12/2/15] In order to use the tools we created easily, they have been formatted as executable commands through these steps:
\begin{enumerate}
	\item Add \#!/bin/bash or \#!/bin/usr/python to the top of the file.
	\item > chmod +x <file>
\end{enumerate}
This will allow us to put them in /usr/bin and call them from any directory to easily mount all the dwarfs, shutdown all of the dwarfs, change and reboot the network to use the internet or go back on to the switch, or execute LINPACK. While not a drastic change, this should prove to make our lives a little easier.
\end{description}

\section{Current State of Cluster}
\begin{description}
\item [12/2/15] An overview of the cluster as the end of the first semester concludes. \\ \\
Hardware:
\begin{itemize}
 	\item Eight functioning odroids, two non functioning.
	\item One switch.
	\item Power supply with nine power cables.
	\item Eight one gigabit ethernet cables.
	\item All securely mounted on an acrylic board. 
\end{itemize}
Configuration:
\begin{itemize}
	\item All odroids are on the same network, connected over the switch (192.169.1.x)
	\item All odroids are named, and able to recognize the IP address of the names of
    the others (i.e. any command that needs an IP can be executed with the name
    instead, such as ping dopey or ssh happy)
	\item Snow White can SSH into any dwarf without a password, and vise versa.
	\item Any dwarf can execute sudo without needed a password input.
	\item The /home directory of Snow White is an NFS share that the dwarfs can mount.
\end{itemize}
Software:
\begin{itemize}
	\item Linpack and ATLAS are built on Snow White, in the home directory.
	\item MPI is installed and working on all eight devices.
	\item Four tools exist in Snow White in the /usr/bin directory:
	\begin{enumerate}
      	\item mountHomeDir - mounts the /home directory of all seven dwarfs to the /home
        directory of Snow White.
      	\item killDwarfs - shuts down the seven dwarfs.
      	\item changeNetwork - changes the network configuration to allow the device to
        	\item connect to the interent instead of the local network, or vise vera.
      	\item LINPACK - executes linpack on a given number of processes. 
      \end{enumerate}
\end{itemize}
Knowledge:
\begin{itemize}
	\item Speed of Etherent switch: ~750 Mbps
	\item Maximum gigaflops possible: ~3e-4
\end{itemize}
Set backs:
\begin{itemize}
	\item Two odroids burned, they have been replaced.
	\item Editing /etc/fstab to automatically mount the home directory of Snow White
    on the dwarfs proved unsuccessful. This is something the team will continue
    to persue in future sprints.
\end{itemize}
\end{description}

% Sprint 4
\section{Creating a Debian Package}
\begin{description}
\item [1/18/16] To create a simple Debian package, we followed the instructions located at:\\ \\
\url{https://wiki.debian.org/IntroDebianPackaging}\\ \\
%add the steps here?
This let us create a Debian package. Going forward, the next step is to use the instructions to make HPLinpack into a Debian package.
\end{description}

\section{USB to USB Communication}
\begin{description}
\item [1/26/16] Figuring out how to communicate through USB. In /etc/network/interface, changed USB's from static to dhcp. Then performed: \\ \\ 
> sudo ifup usb0 \\ \\
Setting up the USB IP Addresses, go the the ODROID to change: \\
> wget http://tex.stackexchange.com \\
> sudo modprob g\textunderscore ether \\
> dmesg \\
> sudo ifconfig usb0 ipaddress \\

Verify the USB IP address was changed. \\
> ifconfig \\ \\
Changed Doc, Happy, Bashful, and Sneezy's USB IP addresses:
	\begin{itemize}
		\item Doc - 192.168.1.25
		\item Happy - 192.168.1.26
		\item Bashful - 192.168.1.27
		\item Sneezy - 192.168.1.28
	\end{itemize}
\item[2/1/16] Over USB 2.0, it is possible to use USB crossover cables to simulate Ethernet over USB. The same technology is possible for USB 3.0, but no operating system currently supports it, Linux or otherwise. As such, direct communication would have to be done in a different way than Ethernet, such as PyUSB. However, there is no found way to communicate from hsot node to another host node using PyUSB.
\end{description}

\section{GPIO Communication}
\begin{description}
\item [2/4/16]  Connected index pin 8 (UART TXD) (Export Pin 172) on Doc to index pin 6 (UART RXD) (Export Pin 171) on Happy. Communicating by changing the physical bit in the corresponding GPIO export pin file (not the physical index number).  \\
%put a gpio diagram somewhere and reference it here

In Happy: \\
> cd /sys/class/gpio \\ \\
Mount the export pin: \\
> echo 171 > export \\ \\
It makes gpio171\\
> cd gpio171 \\ \\
Edit the text file direction:\\
>echo in > direction \\ \\
In Doc: \\
> cd /sys/class/gpio \\
> echo 172 > export \\
It makes a directory for that pin number. \\
> cd gpio172 \\
Edit the text file direction to out: \\
> echo out > direction \\
Edit the text file direction: \\
> echo 1 > value \\ \\
In Happy: \\
> cd /sys/class/gpio/gpio171 \\
> echo value \\
It'll print 1 \\ \\
Repeat with value 0. Happy's value will be 0. \\ \\
To unmount the GPIO Export Pin: \\
In Happy: \\
> cd /sys/class/gpio \\
> echo 171 > unexport \\ \\
In Doc: \\
> cd /sys/class/gpio \\
> echo 172 > unexport

\item [2/11/16] Successfully got wiringPi to work between two dwarfs. We got 0.61 MBits\/sec on GPIO with one pin. Communication speed between two dwarfs through Ethernet was 750 MBits/sec. This was found using iperf. GPIO was 120 times slower than Ethernet. It was concluded that GPIO will not be continued for this project.

\end{description}

\section{Updating Kernel}
\begin{description}
\item [2/6/16] Trying to install the wiringPi2 library on the ODROIDs to communicate via GPIO. Our online sources said we need to update the kernels. \\ \\
Change the fstab so it doesn't mount Snow White's home directory automatically. (Comment out) \\
Edit etc/interfaces, comment out so the ODROID can connect to the internet.\\
Reboot the ODROID.\\
Connect to internet ethernet while rebooting. \\
Check the current kernel: \\
> uname -a \\ \\
Update the repos: \\
> sudo apt-get update \\ \\
Upgrade the kernel: \\
> apt-get upgrade linux-image-xu3 \\ \\
Got a purple screen prompting if we want to continue and if we know what we're doing. Continued. \\
Ignore warning errors. \\
Check the current kernel to see if it successfully updated: \\
> uname -a \\ \\
Upgrade all of the packages for the kernel: \\
> sudo apt-get update \&\& sudo apt-get dist upgrade
\end{description}